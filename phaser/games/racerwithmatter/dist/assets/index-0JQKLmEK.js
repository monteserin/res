import{p as t}from"./phaser-C2_wa_Fb.js";!function(){const t=document.createElement("link").relList;if(!(t&&t.supports&&t.supports("modulepreload"))){for(const t of document.querySelectorAll('link[rel="modulepreload"]'))e(t);new MutationObserver((t=>{for(const s of t)if("childList"===s.type)for(const t of s.addedNodes)"LINK"===t.tagName&&"modulepreload"===t.rel&&e(t)})).observe(document,{childList:!0,subtree:!0})}function e(t){if(t.ep)return;t.ep=!0;const e=function(t){const e={};return t.integrity&&(e.integrity=t.integrity),t.referrerPolicy&&(e.referrerPolicy=t.referrerPolicy),"use-credentials"===t.crossOrigin?e.credentials="include":"anonymous"===t.crossOrigin?e.credentials="omit":e.credentials="same-origin",e}(t);fetch(t.href,e)}}();class e extends t.Scene{constructor(){super("Boot")}preload(){window.location.hostname.startsWith("localhost")||this.load.setPath("/res/phaser/games/racerwithmatter/dist"),this.load.spritesheet("player0","assets/player0.png",{frameWidth:64,frameHeight:32}),this.load.spritesheet("player1","assets/player1.png",{frameWidth:64,frameHeight:32}),this.load.spritesheet("player2","assets/player2.png",{frameWidth:64,frameHeight:32}),this.load.spritesheet("player3","assets/player3.png",{frameWidth:64,frameHeight:32}),this.load.image("background","assets/background.jpg"),this.load.image("leftside","/assets/leftside.png"),this.load.image("rightside","/assets/rightside.png"),this.load.image("center","/assets/center.png"),this.load.image("moon","/assets/moon.png"),this.load.image("saturn","/assets/saturn.png"),this.load.image("astronaut","/assets/astronaut.png"),this.load.json("matter","/matter.json"),this.load.image("2players","assets/2.png"),this.load.image("3players","assets/3.png"),this.load.image("4players","assets/4.png"),this.load.image("landscreen","assets/landscreen.jpg"),this.load.image("win","assets/win.jpg")}create(){this.scene.start("MainMenu")}}class s extends t.Scene{constructor(){super("Game")}init(t){this.amountOfPlayers=t.amountOfPlayers}create(){this.cursors=this.input.keyboard.createCursorKeys(),this.add.sprite(0,0,"background").setOrigin(0,0),this.playersCoordinates=[{x:280,y:500,leftbtn:{x:30,y:540,rotation:45},rightbtn:{x:90,y:600,rotation:45}},{x:360,y:500,leftbtn:{x:870,y:30,rotation:45},rightbtn:{x:930,y:90,rotation:45}},{x:300,y:550,leftbtn:{x:30,y:90,rotation:-45},rightbtn:{x:90,y:30,rotation:-45}},{x:380,y:550,leftbtn:{x:870,y:600,rotation:-45},rightbtn:{x:930,y:540,rotation:-45}}],this.players=[],this.createPlayers();const t=this.cache.json.get("matter"),e=this.matter.add.sprite(181,303,"leftside",null,{shape:t.leftside}),s=this.matter.add.sprite(797,314.5,"rightside",null,{shape:t.rightside}),a=this.matter.add.sprite(472,344,"center",null,{shape:t.center}),r=this.matter.add.sprite(170,160,"moon",null,{shape:t.moon});this.matter.add.sprite(717,240,"astronaut",null,{shape:t.astronaut});const i=this.matter.add.sprite(740,150,"saturn",null,{shape:t.saturn});e.setStatic(!0),s.setStatic(!0),a.setStatic(!0),i.setStatic(!0),r.setBounce(1.5),this.matter.add.rectangle(175,500,135,30,{isSensor:!0,marker:1,angle:-.25*Math.PI}),this.matter.add.rectangle(450,150,30,60,{isSensor:!0,marker:2}),this.matter.add.rectangle(760,400,90,30,{isSensor:!0,marker:3}),this.matter.add.rectangle(500,505,30,70,{isSensor:!0,marker:4}),this.matter.world.on("collisionstart",(t=>{for(var e=t.pairs,s=0;s<e.length;s++){var a=e[s].bodyA,r=e[s].bodyB;if(e[s].isSensor){let t,e;a.isSensor?(t=a,e=r):r.isSensor&&(t=r,e=a);const s=e.gameObject;if(s.getData("marker")===t.marker)if(4===t.marker)s.setData("marker",1);else{if(1===t.marker){const t=s.texture.key.substr(-1),e=s.getData("score")+1;s.setData("score",e),console.log("33333333333",e,`score${t}`,s.getData(e)),this[`score${t}`].text=`${s.getData("score")}`,2===e&&this.scene.start("Win")}console.log("Increase marker. Esto ocurrirÃ¡ cuando demos una vuelta completa"),s.setData("marker",t.marker+1)}}}})),this.showScore()}showScore(){this.add.text(400,275,"P1:",{fontFamily:"font1",fontSize:24,color:"#00ff00"}),this.add.text(480,275,"P2:",{fontFamily:"font1",fontSize:24,color:"#00ff00"}),this.add.text(400,315,"P3:",{fontFamily:"font1",fontSize:24,color:"#00ff00"}),this.add.text(480,315,"P4:",{fontFamily:"font1",fontSize:24,color:"#00ff00"}),this.score0=this.add.text(440,275,"0",{fontFamily:"font1",fontSize:24,color:"#ffffff"}),this.score1=this.add.text(520,275,"0",{fontFamily:"font1",fontSize:24,color:"#ffffff"}),this.score2=this.add.text(440,315,"0",{fontFamily:"font1",fontSize:24,color:"#ffffff"}),this.score3=this.add.text(520,315,"0",{fontFamily:"font1",fontSize:24,color:"#ffffff"})}createPlayers(){for(let t=0;t<this.amountOfPlayers;t++)this.players[t]=this.matter.add.sprite(this.playersCoordinates[t].x,this.playersCoordinates[t].y,`player${t}`),this.players[t].setData("marker",2),this.players[t].setData("score",0),this.anims.create({key:`fly${t}`,frames:this.anims.generateFrameNumbers(`player${t}`,{start:0,end:1}),frameRate:10,repeat:-1}),this.players[t].play(`fly${t}`,!0),this.visualControls(t),this.players[t].setData("score",0),this.players[t].setData("marker",2)}visualControls(t){this.players[t].setData("horizontalDirection",0);const e=this.add.sprite(this.playersCoordinates[t].leftbtn.x,this.playersCoordinates[t].leftbtn.y,"arrow").setInteractive();e.angle=this.playersCoordinates[t].leftbtn.rotation;const s=this.add.sprite(this.playersCoordinates[t].rightbtn.x,this.playersCoordinates[t].rightbtn.y,"arrow").setInteractive();s.angle=this.playersCoordinates[t].rightbtn.rotation,s.flipX=!0,s.on("pointerdown",(function(){this.scene.players[t].setData("horizontalDirection",1)})),e.on("pointerdown",(function(){this.scene.players[t].setData("horizontalDirection",-1)})),s.on("pointerup",(function(){this.scene.players[t].setData("horizontalDirection",0)})),e.on("pointerup",(function(){this.scene.players[t].setData("horizontalDirection",0)}))}update(){for(let t=0;t<this.amountOfPlayers;t++)this.players[t].thrust(-.001),this.cursors.left.isDown||-1===this.players[t].getData("horizontalDirection")?this.players[t].setAngularVelocity(-.065):(this.cursors.right.isDown||1===this.players[t].getData("horizontalDirection"))&&this.players[t].setAngularVelocity(.065)}}class a extends t.Scene{constructor(){super("Win")}create(){this.add.image(0,0,"win").setOrigin(0),this.input.once("pointerdown",(()=>{this.scene.start("MainMenu")}))}}class r extends t.Scene{constructor(){super("MainMenu")}create(){this.add.sprite(0,0,"landscreen").setOrigin(0);const t=this.add.sprite(280,550,"2players").setInteractive(),e=this.add.sprite(480,550,"3players").setInteractive(),s=this.add.sprite(680,550,"4players").setInteractive();t.on("pointerdown",(()=>this.chooseAmountOfPlayers(2))),e.on("pointerdown",(()=>this.chooseAmountOfPlayers(3))),s.on("pointerdown",(()=>this.chooseAmountOfPlayers(4)))}chooseAmountOfPlayers(t){this.scene.start("Game",{amountOfPlayers:t})}}class i extends t.Scene{constructor(){super("Preloader")}init(){this.add.image(512,384,"background"),this.add.rectangle(512,384,468,32).setStrokeStyle(1,16777215);const t=this.add.rectangle(282,384,4,28,16777215);this.load.on("progress",(e=>{t.width=4+460*e}))}preload(){this.load.setPath("assets"),this.load.image("logo","logo.png")}create(){this.scene.start("MainMenu")}}const o={type:Phaser.AUTO,width:960,height:640,parent:"game-container",backgroundColor:"#028af8",scale:{mode:Phaser.Scale.FIT,autoCenter:Phaser.Scale.CENTER_BOTH},physics:{default:"matter",matter:{gravity:{y:0},debug:!1}},scene:[e,i,r,s,a]};new Phaser.Game(o);
